"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[725],{1725:function(e,s,t){t.d(s,{zL:function(){return x}});var r=t(7437),a=t(2265),o=t(6401),n=t(8502);function l(e){let{message:s,professor:t}=e;if("user"===s.role)return(0,r.jsx)("div",{className:"flex justify-end mb-4",children:(0,r.jsx)("div",{className:"max-w-[80%] bg-[#7A9E8E] text-white px-4 py-3 rounded-2xl rounded-br-md",children:(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:s.content})})});if("assistant"===s.role)return(0,r.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"".concat(t.accentColor,"15")},children:(0,r.jsx)(n.qR,{professorId:t.id,className:"w-8 h-8",color:t.accentColor})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:t.shortName}),(0,r.jsx)("div",{className:"px-4 py-3 rounded-2xl rounded-tl-md",style:{backgroundColor:"".concat(t.accentColor,"10")},children:(0,r.jsx)("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:s.content})})]})]});if(s.isHandoff){let e=s.professorId?(0,o.kT)(s.professorId):null;return(0,r.jsx)("div",{className:"flex justify-center mb-4",children:(0,r.jsxs)("div",{className:"bg-gray-100 px-4 py-2 rounded-full text-sm text-gray-600 flex items-center gap-2",children:[(0,r.jsx)("span",{children:"\uD83D\uDD04"}),(0,r.jsx)("span",{children:s.content}),e&&(0,r.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:e.accentColor},children:(0,r.jsx)(n.qR,{professorId:e.id,className:"w-5 h-5",color:"#fff"})})]})})}return null}function i(e){let{onSend:s,isLoading:t,placeholder:o="Napiš zpr\xe1vu..."}=e,[n,l]=(0,a.useState)(""),i=(0,a.useRef)(null);(0,a.useEffect)(()=>{i.current&&(i.current.style.height="auto",i.current.style.height="".concat(Math.min(i.current.scrollHeight,120),"px"))},[n]);let c=e=>{null==e||e.preventDefault(),n.trim()&&!t&&(s(n.trim()),l(""))};return(0,r.jsxs)("form",{onSubmit:c,className:"flex gap-2 items-end p-4 border-t border-gray-200 bg-white",children:[(0,r.jsx)("div",{className:"flex-1 relative",children:(0,r.jsx)("textarea",{ref:i,value:n,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c())},placeholder:o,disabled:t,rows:1,className:"w-full px-4 py-3 pr-12 border border-gray-200 rounded-2xl resize-none focus:outline-none focus:ring-2 focus:ring-[#7A9E8E]/50 focus:border-[#7A9E8E] disabled:bg-gray-50 disabled:text-gray-400 text-sm",style:{maxHeight:"120px"}})}),(0,r.jsx)("button",{type:"submit",disabled:!n.trim()||t,className:"w-11 h-11 flex-shrink-0 bg-[#7A9E8E] text-white rounded-xl flex items-center justify-center hover:bg-[#6A8E7E] disabled:bg-gray-200 disabled:text-gray-400 transition-colors",children:t?(0,r.jsxs)("svg",{className:"w-5 h-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",strokeOpacity:"0.3"}),(0,r.jsx)("path",{d:"M12 2a10 10 0 0 1 10 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}):(0,r.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:(0,r.jsx)("path",{d:"M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"})})})]})}function c(e){let{professor:s,onSelect:t,lessonTitle:a}=e,o=[a?"Vysvětli mi ".concat(a):null,"Můžeš to vysvětlit jednodušeji?","Dej mi př\xedklad z praxe","Co je nejdůležitějš\xed zapamatovat si?","Jak to můžu procvičit?"].filter(Boolean);return(0,r.jsxs)("div",{className:"px-4 py-3 border-t border-gray-100",children:[(0,r.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:"Rychl\xe9 ot\xe1zky:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map(e=>(0,r.jsx)("button",{onClick:()=>t(e),className:"px-3 py-1.5 text-xs bg-gray-100 hover:bg-gray-200  rounded-full text-gray-700 transition-colors",children:e},e))})]})}function d(e){let{currentProfessorId:s,onSelect:t,suggestedProfessorId:a}=e;return(0,r.jsx)("div",{className:"flex gap-2 p-3 overflow-x-auto",children:o.Uh.map(e=>{let o=e.id===s,l=e.id===a;return(0,r.jsxs)("button",{onClick:()=>t(e.id),className:"\n              flex items-center gap-2 px-3 py-2 rounded-xl transition-all flex-shrink-0\n              ".concat(o?"bg-[#7A9E8E] text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700","\n              ").concat(l&&!o?"ring-2 ring-amber-400 ring-offset-1":"","\n            "),children:[(0,r.jsx)("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center",style:{backgroundColor:o?"rgba(255,255,255,0.2)":"".concat(e.accentColor,"15")},children:(0,r.jsx)(n.qR,{professorId:e.id,className:"w-5 h-5",color:o?"#fff":e.accentColor})}),(0,r.jsx)("span",{className:"text-sm font-medium",children:e.shortName}),l&&!o&&(0,r.jsx)("span",{className:"text-xs bg-amber-400 text-amber-900 px-1.5 py-0.5 rounded-full",children:"doporučen\xfd"})]},e.id)})})}function x(e){let{initialProfessorId:s="davinci",lessonContext:t,onClose:x,className:u=""}=e,[m,f]=(0,a.useState)([]),[h,p]=(0,a.useState)(s),[g,j]=(0,a.useState)(!1),[y,b]=(0,a.useState)(),[v,w]=(0,a.useState)(!0),N=(0,a.useRef)(null),k=(0,o.kT)(h),C=(0,a.useCallback)(()=>{var e;null===(e=N.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[]);(0,a.useEffect)(()=>{C()},[m,C]),(0,a.useEffect)(()=>{0===m.length&&f([{id:"1",role:"assistant",content:(null==t?void 0:t.lessonTitle)?'V\xedt\xe1m tě u lekce "'.concat(t.lessonTitle,'"! ').concat(k.signaturePhrases[0]||""," Co bys chtěl/a probrat?"):k.introMessage||"".concat(k.signaturePhrases[0]||"Ahoj!"," Jak ti můžu pomoct?"),professorId:h,timestamp:new Date}])},[]);let D=async e=>{if(!e.trim())return;w(!1);let s={id:Date.now().toString(),role:"user",content:e,timestamp:new Date};f(e=>[...e,s]),j(!0);try{var r;let e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...m,s],professorId:h,lessonContext:t,checkHandoff:!0})});if(!e.ok)throw Error("Chat API error");let a=await e.json(),o={id:(Date.now()+1).toString(),role:"assistant",content:a.message,professorId:h,timestamp:new Date};f(e=>[...e,o]),(null===(r=a.handoff)||void 0===r?void 0:r.suggested)?b(a.handoff.toProfessorId):b(void 0)}catch(e){console.error("Chat error:",e),f(e=>[...e,{id:(Date.now()+1).toString(),role:"assistant",content:"Omlouv\xe1m se, něco se pokazilo. Zkus to pros\xedm znovu.",professorId:h,timestamp:new Date}])}finally{j(!1)}};return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-white rounded-xl shadow-lg overflow-hidden ".concat(u),children:[(0,r.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between",style:{backgroundColor:k.accentColor},children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center",children:(0,r.jsx)(n.qR,{professorId:k.id,className:"w-8 h-8",color:"#fff"})}),(0,r.jsxs)("div",{className:"text-white",children:[(0,r.jsx)("h3",{className:"font-semibold",children:k.name}),(0,r.jsx)("p",{className:"text-xs opacity-80",children:k.tagline})]})]}),x&&(0,r.jsx)("button",{onClick:x,className:"w-8 h-8 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center text-white transition-colors",children:(0,r.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,r.jsx)("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),(0,r.jsx)(d,{currentProfessorId:h,onSelect:e=>{if(e===h)return;let s=(0,o.kT)(e),t={id:Date.now().toString(),role:"system",content:"".concat(k.shortName," předal/a konverzaci ").concat(s.shortName),professorId:e,timestamp:new Date,isHandoff:!0},r={id:(Date.now()+1).toString(),role:"assistant",content:"".concat(s.signaturePhrases[0]||"Ahoj!"," Převzal/a jsem štafetu. Jak ti můžu pomoct?"),professorId:e,timestamp:new Date};f(e=>[...e,t,r]),p(e),b(void 0)},suggestedProfessorId:y}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[m.map(e=>(0,r.jsx)(l,{message:e,professor:e.professorId?(0,o.kT)(e.professorId):k},e.id)),g&&(0,r.jsxs)("div",{className:"flex gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center",style:{backgroundColor:"".concat(k.accentColor,"15")},children:(0,r.jsx)(n.qR,{professorId:k.id,className:"w-8 h-8",color:k.accentColor})}),(0,r.jsx)("div",{className:"px-4 py-3 rounded-2xl rounded-tl-md",style:{backgroundColor:"".concat(k.accentColor,"10")},children:(0,r.jsxs)("div",{className:"flex gap-1",children:[(0,r.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,r.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,r.jsx)("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),(0,r.jsx)("div",{ref:N})]}),v&&m.length<=2&&(0,r.jsx)(c,{professor:k,onSelect:D,lessonTitle:null==t?void 0:t.lessonTitle}),(0,r.jsx)(i,{onSend:D,isLoading:g,placeholder:"Zeptej se ".concat(k.shortName,"...")})]})}}}]);